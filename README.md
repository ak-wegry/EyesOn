# ![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn.png) EyesOn
ファイル変化監視ツール

EyesOnは、Windowsのファイルやフォルダ内の変化を監視し、変化があった場合に通知するツールです。

## 動作環境
- Windows10

## コンパイラ
- Borland C++ 5.5.1 for Win32

## 使い方
- EyesOn.exeをPCローカルの適当なフォルダに格納して、起動します。  
(起動すると同一フォルダに、登録/監視情報などを保存するEyesOn.iniを作成します)
- ExplorerからファイルやフォルダをEyesOnにドラッグ＆ドロップします。
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Ope1.png)
- EyesOn上でドラッグ＆ドロップしたファイル/フォルダをリストから選択し、  
メニュー(*)から監視有無/監視周期/監視パターンを設定します。  
必要に応じて、EyesOn上での表示タイトル/グループを設定します。  
*:右クリックメニュー、または、メニュー「リスト」
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Ope2.png)
- 変化があるとリスト上の「●」とアイコンの色(黄色)により通知されます。  
変化内容は、リストの内容を開く(Enter)/フォルダを開く(Shift+Enter)で確認します。
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Ope3.png)

## 機能仕様
### 動作概要
- リストが「◎:監視あり」に設定された時点で、
リストの「監視開始時刻」を現在時刻で更新する。

- 5分周期で、登録されたリストの変化を
「監視開始時刻」「監視周期」「現在時刻」「アクセス日時」から判定し、
変化があれば、リスト「●:変化あり」/アイコン「変化あり(黄色)」に設定する。  
(ファイル/フォルダにアクセスできない場合は、リスト「×:アクセス不可」設定)

- 「●:変化あり」リストを開くと、「監視開始時刻」を更新し、
リスト「◎:変化なし」/アイコン「変化なし」に設定する。

### 監視方法
- 監視対象がファイルの場合は、ファイルのアクセス日時により判定する。  
(更新日時の古いファイルを別のフォルダからコピーした場合、ファイルの更新日時は変化がない為)

- 監視対象がフォルダの場合は、監視パターンに応じて、
判定対象の最も新しいアクセス日時により判定する。

|監視パターン  |判定対象                          |
|--------------|----------------------------------|
|更新+追加     |フォルダ配下のファイル内          |
|更新+追加+削除|フォルダとフォルダ配下のファイル内|

ただし、MS-Officeファイルは開くだけで一時ファイルが生成され、
フォルダの更新時刻が更新される為、フォルダ配下のファイル検索では、
検知不要の一時ファイル等を除外する。  
(初期の除外条件は「~*;.*」としているが、メニュー「アプリ」から変更可能)

### グループ設定

複数のリストをグループ設定すると先頭が「親リスト」、
その他が「子リスト」となり、「子リスト」はタイトルが字下げして表示される。
グループ設定されたリストは、ソートした場合でも連続した状態で表示される。

- 設定例1  
リストを選択して「グループ設定」する
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Group1.png)

- 設定例2  
更にリストを選択して「グループ設定」する
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Group2.png)

- 設定例3  
追加したリストを移動し、設定済みグループを含めてリスト選択してグループ設定
![](https://github.com/ak-wegry/EyesOn/blob/main/images/EyesOn_Group3.png)
